<h1 id="capturing-your-query-environment">Capturing your query environment</h1>

<p>When working with IBM Support to resolve a performance problem with an SQL statement, you can use the Capture Query Environment feature to capture the statement’s environment in a set of files.</p>

<ol>
  <li>
    <p>Open an SQL file and click on the connection in the <a href="https://code.visualstudio.com/docs/getstarted/userinterface">Status Bar</a>. Select a Db2 connection from the list that’s displayed. If you are using a tuning profile, make sure the connection that you select already has a tuning profile associated with it. If not, see <a href="/Aparna-Ashokan/Db2-developer-extension-staging/docs/tuning-sql-queries/setting-up-a-tuning-environment.html#optional-creating-a-tuning-profile">Creating a tuning profile</a>.</p>

    <p><strong>Note:</strong> The message “No connection” is displayed in the <strong>Status Bar</strong> if a Db2 connection hasn’t been associated with the profile.</p>
  </li>
  <li>
    <p>Right-click in the .sql file and select <strong>SQL Tuning Options</strong>. The <strong>Customize Tuning Options</strong> dialog is displayed.</p>
  </li>
  <li>
    <p>Verify that the tuning options, such as SQL ID, schema, and current path, are correct for the environment that you want to capture.</p>
  </li>
  <li>
    <p>If you changed any tuning options, click <strong>Save</strong>.  Otherwise, close the <strong>Customize Tuning Options</strong> dialog. The SQL statement is redisplayed.</p>

    <p><img src="/Aparna-Ashokan/Db2-developer-extension-staging/assets/images/tuning-common-actions.gif" alt="Running tuning actions" /></p>
  </li>
  <li>
    <p>Select the entire statement, right-click, and select <strong>Tune Selected SQL</strong>. The <strong>Tuning Actions</strong> dialog opens in the right side of the editor, and the statement is displayed at the top of the dialog.</p>
  </li>
  <li>
    <p>Select the <strong>Capture Query Environment</strong> checkbox and click <strong>Tune</strong>.</p>

    <p>The <strong>Tuning Summary</strong> window opens, which shows that the status for Capture Query Environment is Pending. When the job completes, the status changes to Success.</p>
  </li>
  <li>
    <p>From the <strong>TUNING HISTORY</strong> view, select <strong>Capture Query Environment</strong>, then specify the full path to contain the results.</p>
  </li>
  <li>
    <p>Press <strong>Enter</strong>. A message is displayed that indicates that the results of running Capture Query Environment were successfully saved in the path that you specified.</p>
  </li>
  <li>
    <p>Go to Explorer to locate the file.</p>

    <p><img src="/Aparna-Ashokan/Db2-developer-extension-staging/assets/images/tuning-capture-query-environment.gif" alt="Capture Query Environment tuning action" /></p>
  </li>
</ol>
